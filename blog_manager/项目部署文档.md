# 博客管理系统 - 后端部署文档

本文档详细介绍了如何部署博客管理系统的后端服务。

## 1. 系统环境要求

在部署之前，请确保您的服务器或本地环境满足以下要求：

- **Java Development Kit (JDK)**: `Java 17`。项目基于Java 17，请确保安装了正确版本的JDK。
- **Maven**: `3.6+`。用于项目构建和依赖管理。
- **MySQL数据库**: `5.7+` 或 `8.0+`。建议使用8.0以上版本。
- **操作系统**: Windows, Linux, 或 macOS。

## 2. 数据库设置

数据库是本系统的核心，存储了所有用户和博客数据。

### 步骤 1: 安装并启动MySQL服务

如果您尚未安装MySQL，请先下载并安装。确保MySQL服务正在运行。

### 步骤 2: 创建数据库和表

我们提供了两种方式来初始化数据库：

#### 方式一：使用自动化脚本（推荐，仅限Windows）

项目根目录下提供了一个 `setup_database.bat` 脚本，可以自动完成数据库的创建、表结构生成以及配置文件的更新。

1. 双击运行 `setup_database.bat` 文件。
2. 按照提示输入您的MySQL用户名、密码、主机和端口。
3. 脚本将自动执行 `database_setup.sql` 并更新 `application.properties` 配置文件。

#### 方式二：手动设置

1. 使用MySQL客户端（如MySQL Command Line Client, Navicat, DataGrip等）连接到您的数据库。
2. 执行根目录下的 `database_setup.sql` 脚本。这会创建名为 `blog_manager` 的数据库，并初始化所需的表（`users`, `blogs`）和数据（默认管理员账户）。

   ```bash
   # 使用root用户登录MySQL
   mysql -u root -p

   # 执行SQL脚本
   source /path/to/your/project/database_setup.sql;
   ```

   请将 `/path/to/your/project/` 替换为项目的实际绝对路径。

## 3. 后端项目配置

项目的主要配置文件有两个：

### 1. `src/main/resources/application.properties`

这个文件包含了Spring Boot应用的核心配置。

- **数据库连接**:
  如果您没有使用 `setup_database.bat` 脚本，请务必手动检查并修改以下数据库连接信息，确保与您的环境匹配：

  ```properties
  spring.datasource.url=jdbc:mysql://localhost:3306/blog_manager?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
  spring.datasource.username=your_mysql_username
  spring.datasource.password=your_mysql_password
  ```
- **服务器端口**:
  默认端口为 `5200`，您可以根据需要修改：

  ```properties
  server.port=5200
  ```

### 2. `config.json`

此文件位于项目根目录，用于配置外部服务。

```json
{
  "xmodelAPIKey" : "your_xmodel_api_key",
  "bigmodelAPIKey" : "your_bigmodel_api_key"
}
```

- `xmodelAPIKey`, `bigmodelAPIKey`: 系统集成的大模型服务API密钥。

**注意**: 博客文件自动存储在项目根目录的 `blogs` 文件夹中，图片文件自动存储在项目根目录的 `images` 文件夹中，无需额外配置。

## 4. 项目构建与启动

### 步骤 1: 构建项目

在项目根目录下打开终端或命令行，执行以下Maven命令来编译和打包项目：

```bash
mvn clean install
```

构建成功后，会在 `target/` 目录下生成一个 `blog_manager-0.0.1-SNAPSHOT.jar` 文件。

### 步骤 2: 启动应用

您可以通过以下两种方式启动后端服务：

#### 方式一：使用Maven直接运行

在开发环境中，可以方便地使用以下命令启动：

```bash
mvn spring-boot:run
```

#### 方式二：运行JAR包（推荐用于生产环境）

使用 `java -jar` 命令来运行构建好的JAR文件：

```bash
java -jar target/blog_manager-0.0.1-SNAPSHOT.jar
```

应用启动后，您将在控制台看到Spring Boot的启动日志。

## 5. 访问应用

当后端服务成功启动后：

- **API服务地址**: `http://localhost:5200`
- **默认管理员账户**:
  - **用户名**: `admin`
  - **密码**: `admin123`

您可以使用API测试工具（如 Postman, Insomnia）来访问后端接口，或与前端应用进行集成。
