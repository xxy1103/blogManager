<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åšå®¢ç®¡ç†ç³»ç»Ÿæ¶æ„è®¾è®¡æŠ¥å‘Š</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #495057;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
          .header {
            text-align: center;
            background: linear-gradient(135deg, #e3f2fd 0%, #f8f9fa 100%);
            color: #2c3e50;
            padding: 40px 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.05);
            border: 1px solid #e0e6ed;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
          .section {
            background: white;
            margin: 30px 0;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.02);
            border-left: 5px solid #6c5ce7;
        }
        
        .section h2 {
            color: #6c5ce7;
            border-bottom: 2px solid #f8f9fa;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
          .section h3 {
            color: #495057;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
          .mermaid {
            background: white;
            border-radius: 8px;
            padding: 30px;
            margin: 25px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            min-height: 400px;
            overflow: visible;
        }
        
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
          .pattern-card {
            background: #f0f7ff;
            border-left: 4px solid #74b9ff;
            padding: 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .pattern-card h4 {
            color: #6c5ce7;
            margin-top: 0;
            font-size: 1.2em;
        }
          .highlight {
            background: linear-gradient(120deg, #e8f5ff 0%, #f0f7ff 100%);
            padding: 3px 6px;
            border-radius: 4px;
            font-weight: 500;
            color: #6c5ce7;
        }
        
        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
          .tech-item {
            background: linear-gradient(135deg, #74b9ff 0%, #a29bfe 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
            box-shadow: 0 4px 10px rgba(116, 185, 255, 0.2);
        }
          .advantages {
            background: #f0f9ff;
            border-left: 4px solid #74b9ff;
            padding: 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .summary-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #f0f7ff 100%);
            color: #2c3e50;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
            border: 1px solid #e0e6ed;
        }
          .footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #6c757d;
            font-size: 0.9em;
        }
        
        ul, ol {
            padding-left: 25px;
        }
        
        li {
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>åšå®¢ç®¡ç†ç³»ç»Ÿæ¶æ„è®¾è®¡æŠ¥å‘Š</h1>
        <p>åŸºäºSpring Bootçš„RESTful APIåšå®¢åç«¯ç³»ç»Ÿ</p>
        <p>æ¶æ„åˆ†æ â€¢ è®¾è®¡æ¨¡å¼ â€¢ ç³»ç»Ÿè®¾è®¡</p>
    </div>

    <div class="section">
        <h2>1. ç³»ç»Ÿæ¦‚è¿°</h2>
        
        <h3>1.1 é¡¹ç›®èƒŒæ™¯</h3>
        <p>è¯¥åšå®¢ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäº<span class="highlight">Spring Boot 3.4.5</span>æ„å»ºçš„åç«¯APIæœåŠ¡ï¼Œé‡‡ç”¨æ ‡å‡†çš„MVCæ¶æ„æ¨¡å¼ï¼Œæä¾›å®Œæ•´çš„åšå®¢æ–‡ç« ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ–‡ç« çš„å¢åˆ æ”¹æŸ¥ã€å›¾ç‰‡ç®¡ç†ã€é…ç½®ç®¡ç†ä»¥åŠLLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰é›†æˆç­‰åŠŸèƒ½ã€‚</p>
        
        <h3>1.2 æŠ€æœ¯æ ˆ</h3>
        <div class="tech-stack">
            <div class="tech-item">Spring Boot 3.4.5</div>
            <div class="tech-item">Java 17</div>
            <div class="tech-item">Spring Web</div>
            <div class="tech-item">Spring WebFlux</div>
            <div class="tech-item">SnakeYAML</div>
            <div class="tech-item">Gson</div>
            <div class="tech-item">Maven</div>
        </div>
        
        <h3>1.3 ç³»ç»Ÿç‰¹ç‚¹</h3>
        <ul>
            <li><strong>RESTful APIè®¾è®¡</strong>ï¼šéµå¾ªRESTæ¶æ„é£æ ¼ï¼Œæä¾›æ ‡å‡†åŒ–çš„HTTPæ¥å£</li>
            <li><strong>æ–‡ä»¶å­˜å‚¨</strong>ï¼šé‡‡ç”¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ï¼Œæ”¯æŒMarkdownæ ¼å¼æ–‡ç« </li>
            <li><strong>é…ç½®ç®¡ç†</strong>ï¼šæ”¯æŒåŠ¨æ€é…ç½®åŠ è½½å’Œæ›´æ–°</li>
            <li><strong>LLMé›†æˆ</strong>ï¼šé›†æˆå¤šç§å¤§è¯­è¨€æ¨¡å‹APIï¼Œæ”¯æŒæ™ºèƒ½å†…å®¹ç”Ÿæˆ</li>
            <li><strong>æµå¼å“åº”</strong>ï¼šæ”¯æŒServer-Sent Events(SSE)å®ç°å®æ—¶æ•°æ®æ¨é€</li>
        </ul>
    </div>

    <div class="section">
        <h2>2. ç³»ç»Ÿæ¶æ„åˆ†æ</h2>
        
        <h3>2.1 æ•´ä½“æ¶æ„å›¾</h3>        <div class="mermaid">
flowchart TD
    A["`**å®¢æˆ·ç«¯è¯·æ±‚**`"] --> B["`**Spring Bootåº”ç”¨**`"]
    B --> C["`**Controllerå±‚**<br/>æ§åˆ¶å™¨`"]
    C --> D["`**Serviceå±‚**<br/>ä¸šåŠ¡é€»è¾‘`"]
    D --> E["`**Repositoryå±‚**<br/>æ•°æ®è®¿é—®`"]
    E --> F["`**æ–‡ä»¶ç³»ç»Ÿ**<br/>å­˜å‚¨`"]
    
    C --> G["`**LLM Service**<br/>AIæœåŠ¡`"]
    G --> H["`**å¤–éƒ¨LLM API**<br/>æ™ºè°±AI/X-Model`"]
    
    C --> I["`**Config Service**<br/>é…ç½®ç®¡ç†`"]
    I --> J["`**é…ç½®æ–‡ä»¶**<br/>YAML`"]
      C --> K["`**Image Service**<br/>å›¾ç‰‡æœåŠ¡`"]
    K --> L["`**å›¾ç‰‡å­˜å‚¨**<br/>é™æ€èµ„æº`"]
    
    %% æ ·å¼å®šä¹‰
    classDef primaryNode fill:#e3f2fd,stroke:#74b9ff
    classDef controllerNode fill:#f0f7ff,stroke:#a29bfe
    classDef serviceNode fill:#e8f5ff,stroke:#6c5ce7
    classDef storageNode fill:#f0fdff,stroke:#74b9ff
    classDef externalNode fill:#f8f9fa,stroke:#b2bec3
    
    class A,B primaryNode
    class C controllerNode
    class D,G,I,K serviceNode
    class E,F,J,L storageNode
    class H externalNode
        </div>
        
        <h3>2.2 åˆ†å±‚æ¶æ„è¯¦è§£</h3>
        
        <div class="pattern-card">
            <h4>Controllerå±‚ (è¡¨ç°å±‚)</h4>
            <p><strong>èŒè´£</strong>ï¼šå¤„ç†HTTPè¯·æ±‚ï¼Œå‚æ•°éªŒè¯ï¼Œå“åº”æ ¼å¼åŒ–</p>
            <p><strong>ç»„ä»¶</strong>ï¼šBlogController, ConfigController, ImageController, LLMController</p>
            <p><strong>ç‰¹ç‚¹</strong>ï¼šé‡‡ç”¨@RestControlleræ³¨è§£ï¼Œæ”¯æŒRESTful APIè®¾è®¡ï¼Œç»Ÿä¸€è¿”å›Messageå¯¹è±¡</p>
        </div>
        
        <div class="pattern-card">
            <h4>Serviceå±‚ (ä¸šåŠ¡é€»è¾‘å±‚)</h4>
            <p><strong>èŒè´£</strong>ï¼šä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œäº‹åŠ¡ç®¡ç†ï¼Œä¸šåŠ¡è§„åˆ™å®ç°</p>
            <p><strong>ç»„ä»¶</strong>ï¼šConfigService, LLMç›¸å…³æœåŠ¡</p>
            <p><strong>ç‰¹ç‚¹</strong>ï¼šä½¿ç”¨@Serviceæ³¨è§£ï¼Œå®ç°å…·ä½“ä¸šåŠ¡é€»è¾‘</p>
        </div>
        
        <div class="pattern-card">
            <h4>Repositoryå±‚ (æ•°æ®è®¿é—®å±‚)</h4>
            <p><strong>èŒè´£</strong>ï¼šæ•°æ®æŒä¹…åŒ–ï¼Œæ–‡ä»¶æ“ä½œï¼Œæ•°æ®è®¿é—®</p>
            <p><strong>ç»„ä»¶</strong>ï¼šBlogFileService</p>
            <p><strong>ç‰¹ç‚¹</strong>ï¼šå°è£…æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œæä¾›æ•°æ®è®¿é—®æ¥å£</p>
        </div>
    </div>    <div class="section">
        <h2>3. ç³»ç»Ÿç±»å…³ç³»åˆ†æ</h2>
        
        <h3>3.1 å®Œæ•´ç³»ç»Ÿç±»å›¾</h3>
        <div class="mermaid">
classDiagram
    %% æ§åˆ¶å™¨å±‚
    class BlogController {
        -BlogFileService blogFileService
        -List~Blog~ blogList
        +listBlogFilenames() Message
        +returnBlogByPath(String) Message
        +updateBlogInfo(Blog) Message
        +updateBlogContent(Blog) Message
        +addBlog(Blog) Message
        +deleteBlog(String) Message
    }
    
    class LLMController {
        -FactoryInterface factory
        -ConfigService configService
        +streamGenerate(String) ResponseEntity
        +getPrompt(String) Message
    }
    
    class ConfigController {
        -ConfigService configService
        +getConfig() Message
        +updateConfig(Config) Message
    }
    
    class ImageController {
        -Path storageLocation
        +uploadImage(MultipartFile) Message
        +listImages() Message
    }
    
    %% æœåŠ¡å±‚
    class BlogFileService {
        -Path storageLocation
        -Config config
        +listPostFilenames() List~Blog~
        +savePost(Blog) void
        +deleteBlog(Blog) void
        +resolve(String) Path
        +init() void
    }
    
    class ConfigService {
        -Config config
        -String configPath
        +loadConfig() Config
        +saveConfig(Config) void
        +getConfig() Config
        +updateConfig(Config) void
    }
    
    %% æ¨¡å‹å±‚
    class Blog {
        -Path filepath
        -String filename
        -String title
        -LocalDateTime dateTime
        -String categories
        -String tags
        -String saying
        -String content
        +loadContent() String
        +clone() Blog
        +compareTo(Blog) int
        +equals(Object) boolean
    }
    
    class Config {
        -String blogStoragePath
        -String imageStoragePath
        -String xmodelAPIKey
        -String bigmodelAPIKey
        +getBlogStoragePath() String
        +getImageStoragePath() String
    }
    
    class Message {
        -int status
        -Object data
        -String error
        +getStatus() int
        +getData() Object
        +getError() String
    }
    
    %% LLMç›¸å…³ç±»
    class LLM {
        <<abstract>>
        -String APIKey
        -String APIUrl
        -String model
        #ArrayList~POSTMessage~ messagesArray
        -Boolean IsStream
        -String temperature
        +callLLM(StreamCallback) void
        +getAPIKey() String
        +getAPIUrl() String
    }
    
    class BigModel {
        +callLLM(StreamCallback) void
        +sendRequest(String) String
    }
    
    class XModel {
        +callLLM(StreamCallback) void
        +sendRequest(String) String
    }
    
    class FactoryInterface {
        <<interface>>
        +createLLM() LLM
    }
    
    class BigModelFactory {
        +createLLM() LLM
    }
    
    class XModelFactory {
        +createLLM() LLM
    }
    
    class StreamCallback {
        <<interface>>
        +onNext(String) void
        +onError(Throwable) void
        +onComplete() void
    }
    
    class POSTMessage {
        -String role
        -String content
        +getRole() String
        +getContent() String
    }
    
    %% å…³ç³»å®šä¹‰
    BlogController --> BlogFileService : uses
    BlogController --> Blog : manages
    BlogController --> Message : returns
    BlogFileService --> Blog : creates
    BlogFileService --> Config : uses
    
    LLMController --> FactoryInterface : uses
    LLMController --> ConfigService : uses
    LLMController --> Message : returns
    
    ConfigController --> ConfigService : uses
    ConfigController --> Config : manages
    ConfigController --> Message : returns
    
    ConfigService --> Config : manages
    
    FactoryInterface <|.. BigModelFactory : implements
    FactoryInterface <|.. XModelFactory : implements
    
    LLM <|-- BigModel : extends
    LLM <|-- XModel : extends
    
    BigModelFactory --> BigModel : creates
    XModelFactory --> XModel : creates
    
    BigModel --> StreamCallback : uses
    XModel --> StreamCallback : uses
    BigModel --> POSTMessage : uses
    XModel --> POSTMessage : uses
    Blog ..|> Comparable : implements
    Blog ..|> Cloneable : implements
    
    %% æ ·å¼å®šä¹‰
    classDef controllerClass fill:#e3f2fd,stroke:#74b9ff
    classDef serviceClass fill:#f0f7ff,stroke:#a29bfe
    classDef modelClass fill:#e8f5ff,stroke:#6c5ce7
    classDef interfaceClass fill:#f8f9fa,stroke:#b2bec3
    classDef abstractClass fill:#fff3cd,stroke:#ffc107
    
    class BlogController,LLMController,ConfigController,ImageController controllerClass
    class BlogFileService,ConfigService serviceClass
    class Blog,Config,Message,BigModel,XModel,POSTMessage modelClass
    class FactoryInterface,StreamCallback interfaceClass
    class LLM abstractClass
        </div>

        <h3>3.2 ç±»å…³ç³»åˆ†æ</h3>
        
        <div class="pattern-card">
            <h4>ğŸ¯ æ§åˆ¶å™¨å±‚ (Controller Layer)</h4>
            <p><strong>æ ¸å¿ƒèŒè´£</strong>ï¼šå¤„ç†HTTPè¯·æ±‚ï¼Œåè°ƒä¸šåŠ¡é€»è¾‘ï¼Œè¿”å›ç»Ÿä¸€å“åº”æ ¼å¼</p>
            <ul>
                <li><strong>BlogController</strong>ï¼šåšå®¢æ–‡ç« çš„CRUDæ“ä½œ</li>
                <li><strong>LLMController</strong>ï¼šAIå¤§æ¨¡å‹é›†æˆå’Œæµå¼å“åº”</li>
                <li><strong>ConfigController</strong>ï¼šç³»ç»Ÿé…ç½®ç®¡ç†</li>
                <li><strong>ImageController</strong>ï¼šå›¾ç‰‡ä¸Šä¼ å’Œç®¡ç†</li>
            </ul>
        </div>
        
        <div class="pattern-card">
            <h4>ğŸ”§ æœåŠ¡å±‚ (Service Layer)</h4>
            <p><strong>æ ¸å¿ƒèŒè´£</strong>ï¼šå°è£…ä¸šåŠ¡é€»è¾‘ï¼Œæä¾›æ•°æ®æ“ä½œæ¥å£</p>
            <ul>
                <li><strong>BlogFileService</strong>ï¼šåšå®¢æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</li>
                <li><strong>ConfigService</strong>ï¼šé…ç½®æ–‡ä»¶è¯»å†™ç®¡ç†</li>
            </ul>
        </div>
        
        <div class="pattern-card">
            <h4>ğŸ“Š æ¨¡å‹å±‚ (Model Layer)</h4>
            <p><strong>æ ¸å¿ƒèŒè´£</strong>ï¼šæ•°æ®æ¨¡å‹å®šä¹‰ï¼Œä¸šåŠ¡å®ä½“å°è£…</p>
            <ul>
                <li><strong>Blog</strong>ï¼šåšå®¢å®ä½“ï¼Œå®ç°Comparableå’ŒCloneableæ¥å£</li>
                <li><strong>Config</strong>ï¼šç³»ç»Ÿé…ç½®å®ä½“</li>
                <li><strong>Message</strong>ï¼šç»Ÿä¸€å“åº”åŒ…è£…ç±»</li>
                <li><strong>POSTMessage</strong>ï¼šLLMè¯·æ±‚æ¶ˆæ¯å°è£…</li>
            </ul>
        </div>
        
        <div class="pattern-card">
            <h4>ğŸ¤– LLMé›†æˆå±‚ (LLM Integration Layer)</h4>
            <p><strong>æ ¸å¿ƒèŒè´£</strong>ï¼šå¤§è¯­è¨€æ¨¡å‹é›†æˆï¼Œå·¥å‚æ¨¡å¼å®ç°å¤šæ¨¡å‹æ”¯æŒ</p>
            <ul>
                <li><strong>LLM</strong>ï¼šæŠ½è±¡åŸºç±»ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼</li>
                <li><strong>BigModel/XModel</strong>ï¼šå…·ä½“LLMå®ç°</li>
                <li><strong>FactoryInterface</strong>ï¼šå·¥å‚æ¥å£</li>
                <li><strong>StreamCallback</strong>ï¼šæµå¼å“åº”å›è°ƒæ¥å£</li>
            </ul>
        </div>        <h3>3.3 LLMé›†æˆæµç¨‹æ¶æ„</h3>        <div class="mermaid">
flowchart TB
    %% æ§åˆ¶å±‚
    LC["`**LLMController**<br/>ğŸ›ï¸ è¯·æ±‚æ§åˆ¶`"]
    
    %% å·¥å‚å±‚
    FI["`**FactoryInterface**<br/>ğŸ­ å·¥å‚æ¥å£`"]
    BMF["`**BigModelFactory**`"]
    XMF["`**XModelFactory**`"]
    
    %% æ¨¡å‹å±‚
    LLMC["`**LLMæŠ½è±¡ç±»**<br/>ğŸ“‹ é€šç”¨æ¨¡æ¿`"]
    BM["`**BigModel**`"]
    XM["`**XModel**`"]
    
    %% å¤–éƒ¨æœåŠ¡
    API1["`**æ™ºè°±AI**`"]
    API2["`**X-Model**`"]
    
    %% è¿æ¥å…³ç³»
    LC --> FI
    LC --> LLMC
    
    FI --> BMF
    FI --> XMF
    
    BMF --> BM
    XMF --> XM
    
    LLMC -.-> BM    LLMC -.-> XM
    
    BM --> API1
    XM --> API2
    
    %% æ ·å¼å®šä¹‰
    classDef controllerStyle fill:#e3f2fd,stroke:#74b9ff
    classDef factoryStyle fill:#f0f7ff,stroke:#a29bfe
    classDef modelStyle fill:#e8f5ff,stroke:#6c5ce7
    classDef externalStyle fill:#f8f9fa,stroke:#b2bec3
    
    class LC controllerStyle
    class FI,BMF,XMF factoryStyle
    class LLMC,BM,XM modelStyle
    class API1,API2 externalStyle
        </div>
    </div>

    <div class="section">
        <h2>4. è®¾è®¡æ¨¡å¼åˆ†æ</h2>
        
        <h3>4.1 æ ¸å¿ƒè®¾è®¡æ¨¡å¼</h3>
        
        <div class="pattern-card">
            <h4>1. MVC (Model-View-Controller) æ¨¡å¼</h4>
            <p><strong>å®ç°ä½ç½®</strong>ï¼šæ•´ä¸ªç³»ç»Ÿæ¶æ„</p>
            <p><strong>å…·ä½“ä½“ç°</strong>ï¼š</p>
            <ul>
                <li><strong>Model</strong>ï¼šBlog, Message, Configç­‰å®ä½“ç±»</li>
                <li><strong>View</strong>ï¼šRESTful APIå“åº”ï¼ˆJSONæ ¼å¼ï¼‰</li>
                <li><strong>Controller</strong>ï¼šå„ç§Controllerç±»å¤„ç†è¯·æ±‚</li>
            </ul>
            <p><strong>è§£å†³é—®é¢˜</strong>ï¼šåˆ†ç¦»å…³æ³¨ç‚¹ï¼Œæé«˜ä»£ç å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§</p>
        </div>
        
        <div class="pattern-card">
            <h4>2. å·¥å‚æ¨¡å¼ (Factory Pattern)</h4>
            <p><strong>å®ç°ä½ç½®</strong>ï¼šLLMæ¨¡å—</p>
            <p><strong>å…·ä½“ä½“ç°</strong>ï¼š</p>
            <ul>
                <li><strong>FactoryInterface</strong>ï¼šå·¥å‚æ¥å£</li>
                <li><strong>BigModelFactory, XModelFactory</strong>ï¼šå…·ä½“å·¥å‚å®ç°</li>
                <li><strong>BigModel, XModel</strong>ï¼šå…·ä½“äº§å“</li>
            </ul>
            <p><strong>è§£å†³é—®é¢˜</strong>ï¼šå°è£…å¯¹è±¡åˆ›å»ºé€»è¾‘ï¼Œæ”¯æŒå¤šç§LLMå®ç°çš„åŠ¨æ€åˆ‡æ¢</p>
        </div>
        
        <div class="pattern-card">
            <h4>3. æ¨¡æ¿æ–¹æ³•æ¨¡å¼ (Template Method Pattern)</h4>
            <p><strong>å®ç°ä½ç½®</strong>ï¼šLLMæŠ½è±¡ç±»</p>
            <p><strong>å…·ä½“ä½“ç°</strong>ï¼š</p>
            <ul>
                <li><strong>LLMæŠ½è±¡ç±»</strong>ï¼šå®šä¹‰é€šç”¨å±æ€§å’ŒæŠ½è±¡æ–¹æ³•callLLM()</li>
                <li><strong>BigModel, XModel</strong>ï¼šå®ç°å…·ä½“çš„APIè°ƒç”¨é€»è¾‘</li>
            </ul>
            <p><strong>è§£å†³é—®é¢˜</strong>ï¼šå®šä¹‰ç®—æ³•éª¨æ¶ï¼Œå…è®¸å­ç±»é‡å†™ç‰¹å®šæ­¥éª¤</p>
        </div>
        
        <div class="pattern-card">
            <h4>4. è§‚å¯Ÿè€…æ¨¡å¼ (Observer Pattern)</h4>
            <p><strong>å®ç°ä½ç½®</strong>ï¼šæµå¼å“åº”æœºåˆ¶</p>
            <p><strong>å…·ä½“ä½“ç°</strong>ï¼š</p>
            <ul>
                <li><strong>StreamCallbackæ¥å£</strong>ï¼šè§‚å¯Ÿè€…æ¥å£</li>
                <li><strong>SseEmitter</strong>ï¼šè¢«è§‚å¯Ÿè€…ï¼Œæ¨é€æ•°æ®åˆ°å®¢æˆ·ç«¯</li>
            </ul>
            <p><strong>è§£å†³é—®é¢˜</strong>ï¼šå®ç°å¼‚æ­¥æ•°æ®æµå¤„ç†å’Œå®æ—¶æ¨é€</p>
        </div>
        
        <div class="pattern-card">
            <h4>5. å•ä¾‹æ¨¡å¼ (Singleton Pattern)</h4>
            <p><strong>å®ç°ä½ç½®</strong>ï¼šé…ç½®ç®¡ç†</p>
            <p><strong>å…·ä½“ä½“ç°</strong>ï¼š</p>
            <ul>
                <li><strong>ConfigService</strong>ï¼šé€šè¿‡Springçš„@Beanæ³¨è§£å®ç°å•ä¾‹</li>
                <li><strong>Configå¯¹è±¡</strong>ï¼šå…¨å±€å”¯ä¸€çš„é…ç½®å®ä¾‹</li>
            </ul>
            <p><strong>è§£å†³é—®é¢˜</strong>ï¼šç¡®ä¿é…ç½®çš„ä¸€è‡´æ€§å’Œèµ„æºçš„åˆç†ä½¿ç”¨</p>
        </div>
        
        <div class="pattern-card">
            <h4>6. å»ºé€ è€…æ¨¡å¼ (Builder Pattern)</h4>
            <p><strong>å®ç°ä½ç½®</strong>ï¼šBlogå¯¹è±¡æ„é€ </p>
            <p><strong>å…·ä½“ä½“ç°</strong>ï¼š</p>
            <ul>
                <li><strong>Blogç±»</strong>ï¼šæä¾›å¤šç§æ„é€ æ–¹æ³•</li>
                <li><strong>ä¸åŒåœºæ™¯</strong>ï¼šåˆ›å»ºã€æŸ¥è¯¢ã€è§£ææ–‡ä»¶ç­‰ä¸åŒæ„é€ æ–¹å¼</li>
            </ul>
            <p><strong>è§£å†³é—®é¢˜</strong>ï¼šç®€åŒ–å¤æ‚å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹</p>
        </div>
        
        <div class="pattern-card">
            <h4>7. ç­–ç•¥æ¨¡å¼ (Strategy Pattern)</h4>
            <p><strong>å®ç°ä½ç½®</strong>ï¼šLLMç±»å‹é€‰æ‹©</p>
            <p><strong>å…·ä½“ä½“ç°</strong>ï¼š</p>
            <ul>
                <li><strong>LLMæ¥å£</strong>ï¼šç­–ç•¥æ¥å£</li>
                <li><strong>BigModel, XModel</strong>ï¼šå…·ä½“ç­–ç•¥å®ç°</li>
                <li><strong>LLMController</strong>ï¼šä¸Šä¸‹æ–‡ç±»ï¼Œæ ¹æ®å‚æ•°é€‰æ‹©ç­–ç•¥</li>
            </ul>
            <p><strong>è§£å†³é—®é¢˜</strong>ï¼šç®—æ³•æ—çš„å°è£…ï¼Œæ”¯æŒè¿è¡Œæ—¶ç­–ç•¥åˆ‡æ¢</p>
        </div>
    </div>

    <div class="section">
        <h2>5. RESTful APIè®¾è®¡</h2>
        
        <h3>5.1 APIè®¾è®¡åŸåˆ™</h3>
        <div class="advantages">
            <p><strong>èµ„æºå¯¼å‘</strong>ï¼šä»¥èµ„æºä¸ºä¸­å¿ƒè®¾è®¡URLï¼Œå¦‚ /api/blogs</p>
            <p><strong>HTTPæ–¹æ³•è¯­ä¹‰åŒ–</strong>ï¼šGET(æŸ¥è¯¢)ã€POST(åˆ›å»º)ã€PUT/PATCH(æ›´æ–°)ã€DELETE(åˆ é™¤)</p>
            <p><strong>çŠ¶æ€ç è§„èŒƒ</strong>ï¼šåˆç†ä½¿ç”¨HTTPçŠ¶æ€ç è¡¨ç¤ºæ“ä½œç»“æœ</p>
            <p><strong>ç»Ÿä¸€å“åº”æ ¼å¼</strong>ï¼šä½¿ç”¨Messageå¯¹è±¡å°è£…å“åº”æ•°æ®</p>
        </div>
        
        <h3>5.2 APIç»“æ„è®¾è®¡</h3>        <div class="mermaid">
flowchart LR
    A["`**åšå®¢API**<br/>/api/blogs`"] --> B["`**è·å–åˆ—è¡¨**<br/>GET /lists`"]
    A --> C["`**è·å–å†…å®¹**<br/>GET /{year}/{month}/{day}/{filename}/`"]
    A --> D["`**æ›´æ–°ä¿¡æ¯**<br/>GET /{year}/{month}/{day}/{filename}/updateinfo`"]
    A --> E["`**æ›´æ–°å†…å®¹**<br/>POST /{year}/{month}/{day}/{filename}/updatecontent`"]
    A --> F["`**æ·»åŠ åšå®¢**<br/>GET /add`"]
    A --> G["`**åˆ é™¤åšå®¢**<br/>GET /{year}/{month}/{day}/{filename}/delete/`"]
    
    H["`**é…ç½®API**<br/>/api/config`"] --> I["`**è·å–é…ç½®**<br/>GET /`"]
    H --> J["`**æ›´æ–°é…ç½®**<br/>POST /update`"]
    
    K["`**LLM API**<br/>/llm`"] --> L["`**è®¾ç½®ç±»å‹**<br/>GET /set`"]
    K --> M["`**ç”Ÿæˆåšå®¢**<br/>POST /generate`"]
    K --> N["`**æ‰©å±•å†…å®¹**<br/>POST /expand`"]
        </div>
        
        <h3>5.3 ç»Ÿä¸€å“åº”æ ¼å¼</h3>
        <div class="code-block">
{
    "code": 0,        // 0-æˆåŠŸ, 1-å¤±è´¥
    "data": {...},    // å“åº”æ•°æ®
    "message": "..."  // æç¤ºä¿¡æ¯
}
        </div>
    </div>

    <div class="section">
        <h2>6. ç³»ç»Ÿè®¾è®¡ä¼˜åŠ¿</h2>
        
        <h3>6.1 æ¶æ„ä¼˜åŠ¿</h3>
        <div class="advantages">
            <h4>é«˜å†…èšä½è€¦åˆ</h4>
            <p>å„å±‚èŒè´£åˆ†æ˜ï¼Œæ¨¡å—é—´ä¾èµ–å…³ç³»æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•</p>
            
            <h4>å¯æ‰©å±•æ€§å¼º</h4>
            <p>å·¥å‚æ¨¡å¼æ”¯æŒæ–°LLMçš„åŠ¨æ€æ·»åŠ ï¼Œé…ç½®ç³»ç»Ÿæ”¯æŒè¿è¡Œæ—¶ä¿®æ”¹</p>
            
            <h4>å®‰å…¨æ€§è€ƒè™‘</h4>
            <p>æ–‡ä»¶è·¯å¾„è§£æåŒ…å«å®‰å…¨æ£€æŸ¥ï¼Œé˜²æ­¢è·¯å¾„éå†æ”»å‡»</p>
            
            <h4>å¼‚æ­¥å¤„ç†</h4>
            <p>ä½¿ç”¨ExecutorServiceå’ŒSseEmitterå®ç°å¼‚æ­¥å“åº”ï¼Œæå‡ç”¨æˆ·ä½“éªŒ</p>
        </div>
        
        <h3>6.2 ä»£ç è´¨é‡</h3>
        <ul>
            <li><strong>æ—¥å¿—è®°å½•</strong>ï¼šå®Œå–„çš„æ—¥å¿—ç³»ç»Ÿï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§</li>
            <li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§</li>
            <li><strong>é…ç½®å¤–éƒ¨åŒ–</strong>ï¼šæ”¯æŒå¤–éƒ¨é…ç½®æ–‡ä»¶ï¼Œä¾¿äºéƒ¨ç½²å’Œç®¡ç†</li>
            <li><strong>ä»£ç æ³¨é‡Š</strong>ï¼šè¯¦ç»†çš„JavaDocæ³¨é‡Šï¼Œä¾¿äºä»£ç ç†è§£å’Œç»´æŠ¤</li>
        </ul>
    </div>

    <div class="section">
        <h2>7. ç³»ç»Ÿæµç¨‹å›¾</h2>
        
        <h3>7.1 åšå®¢æ–‡ç« ç®¡ç†æµç¨‹</h3>        <div class="mermaid">
sequenceDiagram
    participant C as å®¢æˆ·ç«¯
    participant BC as BlogController
    participant BFS as BlogFileService
    participant FS as æ–‡ä»¶ç³»ç»Ÿ
    
    C->>BC: GET /api/blogs/lists
    BC->>BFS: listPostFilenames()
    BFS->>FS: æ‰«æ.mdæ–‡ä»¶
    FS-->>BFS: æ–‡ä»¶åˆ—è¡¨
    BFS->>BFS: è§£ææ–‡ä»¶å†…å®¹åˆ›å»ºBlogå¯¹è±¡
    BFS-->>BC: List Blog
    BC-->>C: Message(0, blogList, null)
    
    C->>BC: GET /api/blogs/{year}/{month}/{day}/{filename}/
    BC->>BC: searchBydata(tmpblog)
    BC->>BFS: blog.loadContent()
    BFS->>FS: è¯»å–æ–‡ä»¶å†…å®¹
    FS-->>BFS: æ–‡ä»¶å†…å®¹
    BFS-->>BC: åšå®¢å†…å®¹
    BC-->>C: Message(0, blogClone, null)
        </div>
        
        <h3>7.2 LLMé›†æˆæµç¨‹</h3>        <div class="mermaid">
sequenceDiagram
    participant C as å®¢æˆ·ç«¯
    participant LC as LLMController
    participant F as LLMFactory
    participant LLM as LLMå®ä¾‹
    participant API as å¤–éƒ¨LLM_API
    
    C->>LC: GET /llm/set?llmType=XModel
    LC->>F: XModelFactory.createLLM()
    F-->>LC: XModelå®ä¾‹
    
    C->>LC: POST /llm/generate (SSE)
    LC->>LLM: callLLM(prompt, content, callback)
    LLM->>API: HTTPè¯·æ±‚
    API-->>LLM: æµå¼å“åº”
    LLM->>LC: StreamCallback.onData()
    LC-->>C: SSEæ•°æ®æ¨é€
        </div>
    </div>

    <div class="section">
        <h2>8. é…ç½®ç®¡ç†è®¾è®¡</h2>
        
        <h3>8.1 é…ç½®ç®¡ç†æ¶æ„</h3>        <div class="mermaid">
graph TD
    A[åº”ç”¨å¯åŠ¨] --> B[ConfigService.loadConfig]
    B --> C{é…ç½®æ–‡ä»¶å­˜åœ¨?}
    C -->|å¦| D[åˆ›å»ºé»˜è®¤é…ç½®]
    C -->|æ˜¯| E[åŠ è½½ç°æœ‰é…ç½®]
    E --> F{é…ç½®å®Œæ•´æ€§æ£€æŸ¥}
    F -->|ä¸å®Œæ•´| G[è¡¥å……ç¼ºå¤±é…ç½®]
    F -->|å®Œæ•´| H[é…ç½®åŠ è½½å®Œæˆ]
    D --> I[ä¿å­˜é…ç½®åˆ°æ–‡ä»¶]
    G --> I
    I --> H
    H --> J["@Bean Configå¯¹è±¡"]
    J --> K[æ³¨å…¥åˆ°å…¶ä»–ç»„ä»¶]
        </div>
        
        <h3>8.2 é…ç½®ç‰¹æ€§</h3>
        <ul>
            <li><strong>è‡ªåŠ¨åˆå§‹åŒ–</strong>ï¼šé¦–æ¬¡å¯åŠ¨è‡ªåŠ¨åˆ›å»ºé»˜è®¤é…ç½®</li>
            <li><strong>åŠ¨æ€æ›´æ–°</strong>ï¼šæ”¯æŒè¿è¡Œæ—¶é…ç½®ä¿®æ”¹å’Œä¿å­˜</li>
            <li><strong>å®Œæ•´æ€§æ£€æŸ¥</strong>ï¼šå¯åŠ¨æ—¶éªŒè¯é…ç½®å®Œæ•´æ€§</li>
            <li><strong>å›æ»šæœºåˆ¶</strong>ï¼šé…ç½®æ›´æ–°å¤±è´¥æ—¶è‡ªåŠ¨å›æ»š</li>
        </ul>
    </div>

    <div class="summary-box">
        <h2>æ€»ç»“</h2>
        <p>è¯¥åšå®¢ç®¡ç†ç³»ç»Ÿé‡‡ç”¨äº†æˆç†Ÿçš„<strong>Spring Boot + MVC</strong>æ¶æ„ï¼Œåˆç†è¿ç”¨äº†å¤šç§è®¾è®¡æ¨¡å¼ï¼Œå®ç°äº†<strong>é«˜å†…èšä½è€¦åˆ</strong>çš„ç³»ç»Ÿè®¾è®¡ã€‚ç³»ç»Ÿå…·æœ‰è‰¯å¥½çš„<strong>å¯æ‰©å±•æ€§</strong>ã€<strong>å¯ç»´æŠ¤æ€§</strong>å’Œ<strong>å®‰å…¨æ€§</strong>ï¼ŒRESTful APIè®¾è®¡è§„èŒƒï¼Œæ”¯æŒç°ä»£åŒ–çš„æµå¼å“åº”å’Œå¼‚æ­¥å¤„ç†ï¼Œæ˜¯ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„ä¼ä¸šçº§åº”ç”¨ã€‚</p>
    </div>

    <div class="footer">
        <p>åšå®¢ç®¡ç†ç³»ç»Ÿæ¶æ„è®¾è®¡æŠ¥å‘Š | ç”Ÿæˆæ—¶é—´: 2025å¹´6æœˆ9æ—¥</p>
    </div>    <script>        if (typeof mermaid !== 'undefined') {
            mermaid.initialize({
                startOnLoad: false,
                theme: 'default',
                flowchart: {
                    nodeSpacing: 80,
                    rankSpacing: 100,
                    padding: 20
                },
                themeVariables: {
                    primaryColor: '#e3f2fd',
                    primaryTextColor: '#2c3e50',
                    primaryBorderColor: '#74b9ff',
                    lineColor: '#a29bfe',
                    secondaryColor: '#f8f9fa',
                    tertiaryColor: '#f0f7ff',
                    background: '#ffffff',
                    mainBkg: '#e3f2fd',
                    secondBkg: '#f0f7ff',
                    tertiaryBkg: '#ffffff'
                }
            });
            // æ˜¾å¼è°ƒç”¨ mermaid.run() æ¥æ¸²æŸ“æ‰€æœ‰ class="mermaid" çš„å…ƒç´ 
            // æ­¤è„šæœ¬ä½äº body æœ«å°¾ï¼Œå› æ­¤ DOM åº”è¯¥å·²å‡†å¤‡å°±ç»ªã€‚
            mermaid.run();
        } else {
            // æ­¤æ¶ˆæ¯å°†æ˜¾ç¤ºåœ¨æµè§ˆå™¨çš„å¼€å‘è€…æ§åˆ¶å°ä¸­
            console.error("Mermaid.js library not loaded or failed to initialize.");
        }
    </script>
</body>
</html>
